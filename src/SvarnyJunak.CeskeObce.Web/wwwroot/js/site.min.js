var autoComplete=function(){function e(e){function t(e,t){return e.classList?e.classList.contains(t):new RegExp("\\b"+t+"\\b").test(e.className)}function n(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)}function o(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n)}function a(e,o,a,c){n(c||document,o,function(n){for(var o,c=n.target||n.srcElement;c&&!(o=t(c,e));)c=c.parentElement;o&&a.call(c,n)})}if(document.querySelector){var c={selector:0,source:0,minChars:3,delay:150,offsetLeft:0,offsetTop:1,cache:1,menuClass:"",renderItem:function(e,t){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var n=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+e+'">'+e.replace(n,"<b>$1</b>")+"</div>"},onSelect:function(e,t,n){}};for(var l in e)e.hasOwnProperty(l)&&(c[l]=e[l]);for(var s="object"==typeof c.selector?[c.selector]:document.querySelectorAll(c.selector),i=0;i<s.length;i++){var u=s[i];u.sc=document.createElement("div"),u.sc.className="autocomplete-suggestions "+c.menuClass,u.autocompleteAttr=u.getAttribute("autocomplete"),u.setAttribute("autocomplete","off"),u.cache={},u.last_val="",u.updateSC=function(e,t){var n=u.getBoundingClientRect();if(u.sc.style.left=Math.round(n.left+(window.pageXOffset||document.documentElement.scrollLeft)+c.offsetLeft)+"px",u.sc.style.top=Math.round(n.bottom+(window.pageYOffset||document.documentElement.scrollTop)+c.offsetTop)+"px",u.sc.style.width=Math.round(n.right-n.left)+"px",!e&&(u.sc.style.display="block",u.sc.maxHeight||(u.sc.maxHeight=parseInt((window.getComputedStyle?getComputedStyle(u.sc,null):u.sc.currentStyle).maxHeight)),u.sc.suggestionHeight||(u.sc.suggestionHeight=u.sc.querySelector(".autocomplete-suggestion").offsetHeight),u.sc.suggestionHeight))if(t){var o=u.sc.scrollTop,a=t.getBoundingClientRect().top-u.sc.getBoundingClientRect().top;a+u.sc.suggestionHeight-u.sc.maxHeight>0?u.sc.scrollTop=a+u.sc.suggestionHeight+o-u.sc.maxHeight:a<0&&(u.sc.scrollTop=a+o)}else u.sc.scrollTop=0},n(window,"resize",u.updateSC),document.body.appendChild(u.sc),a("autocomplete-suggestion","mouseleave",function(e){var t=u.sc.querySelector(".autocomplete-suggestion.selected");t&&setTimeout(function(){t.className=t.className.replace("selected","")},20)},u.sc),a("autocomplete-suggestion","mouseover",function(e){var t=u.sc.querySelector(".autocomplete-suggestion.selected");t&&(t.className=t.className.replace("selected","")),this.className+=" selected"},u.sc),a("autocomplete-suggestion","mousedown",function(e){if(t(this,"autocomplete-suggestion")){var n=this.getAttribute("data-val");u.value=n,c.onSelect(e,n,this),u.sc.style.display="none"}},u.sc),u.blurHandler=function(){try{var e=document.querySelector(".autocomplete-suggestions:hover")}catch(t){var e=0}e?u!==document.activeElement&&setTimeout(function(){u.focus()},20):(u.last_val=u.value,u.sc.style.display="none",setTimeout(function(){u.sc.style.display="none"},350))},n(u,"blur",u.blurHandler);var r=function(e){var t=u.value;if(u.cache[t]=e,e.length&&t.length>=c.minChars){for(var n="",o=0;o<e.length;o++)n+=c.renderItem(e[o],t);u.sc.innerHTML=n,u.updateSC(0)}else u.sc.style.display="none"};u.keydownHandler=function(e){var t=window.event?e.keyCode:e.which;if((40==t||38==t)&&u.sc.innerHTML){var n,o=u.sc.querySelector(".autocomplete-suggestion.selected");return o?(n=40==t?o.nextSibling:o.previousSibling,n?(o.className=o.className.replace("selected",""),n.className+=" selected",u.value=n.getAttribute("data-val")):(o.className=o.className.replace("selected",""),u.value=u.last_val,n=0)):(n=40==t?u.sc.querySelector(".autocomplete-suggestion"):u.sc.childNodes[u.sc.childNodes.length-1],n.className+=" selected",u.value=n.getAttribute("data-val")),u.updateSC(0,n),!1}if(27==t)u.value=u.last_val,u.sc.style.display="none";else if(13==t||9==t){var o=u.sc.querySelector(".autocomplete-suggestion.selected");o&&"none"!=u.sc.style.display&&(c.onSelect(e,o.getAttribute("data-val"),o),setTimeout(function(){u.sc.style.display="none"},20))}},n(u,"keydown",u.keydownHandler),u.keyupHandler=function(e){var t=window.event?e.keyCode:e.which;if(!t||(t<35||t>40)&&13!=t&&27!=t){var n=u.value;if(n.length>=c.minChars){if(n!=u.last_val){if(u.last_val=n,clearTimeout(u.timer),c.cache){if(n in u.cache)return void r(u.cache[n]);for(var o=1;o<n.length-c.minChars;o++){var a=n.slice(0,n.length-o);if(a in u.cache&&!u.cache[a].length)return void r([])}}u.timer=setTimeout(function(){c.source(n,r)},c.delay)}}else u.last_val=n,u.sc.style.display="none"}},n(u,"keyup",u.keyupHandler),u.focusHandler=function(e){u.last_val="\n",u.keyupHandler(e)},c.minChars||n(u,"focus",u.focusHandler)}this.destroy=function(){for(var e=0;e<s.length;e++){var t=s[e];o(window,"resize",t.updateSC),o(t,"blur",t.blurHandler),o(t,"focus",t.focusHandler),o(t,"keydown",t.keydownHandler),o(t,"keyup",t.keyupHandler),t.autocompleteAttr?t.setAttribute("autocomplete",t.autocompleteAttr):t.removeAttribute("autocomplete"),document.body.removeChild(t.sc),t=null}}}}return e}();!function(){"function"==typeof define&&define.amd?define("autoComplete",function(){return autoComplete}):"undefined"!=typeof module&&module.exports?module.exports=autoComplete:window.autoComplete=autoComplete}(),function(){document.getElementById("municipality-search").focus(),new autoComplete({minChars:1,selector:"input#municipality-search",onSelect:function(e,t,n){var o=n.getAttribute("data-val");document.querySelector("#municipality-search").value=o,document.querySelector("form#select-municipality-form").submit()},source:function(e,t){var n=new XMLHttpRequest;n.open("GET","/api/municipalities?name="+encodeURIComponent(e),!0),n.onload=function(){var e=JSON.parse(n.responseText);t(e)},n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send()}})}(),function(){function e(){var e=document.querySelectorAll(".chart div .bar");Array.prototype.slice.call(e).forEach(function(e){e.style.visibility="visible",e.style.width=e.getAttribute("data-width")})}function t(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}var n=document.querySelectorAll(".data-population-progress>tbody>tr"),o=Array.prototype.map.call(n,function(e,t){return{year:Number(e.children[0].innerText),population:Number(e.children[1].innerText)}}),a=o.reduce(function(e,t){return e>t.population?e:t.population},0),c=function(){var e=document.querySelector(".chart").offsetWidth-60;return 330<e?330:e}(),l=function(e){return e*c/a},s=document.querySelector(".chart"),i=o.map(function(e){return"<div><span class='year-caption'>"+e.year+"</span><span class='bar' data-width='"+l(e.population)+"px' style='width: 0;visibility: hidden;transition: width 2s ease-out'>"+t(e.population)+"</div>"});s.innerHTML=i.join(""),setTimeout(e,500)}(),function(){var e=document.getElementById("map-canvas");if("hidden"!==e.style.visibility&&e.offsetWidth>500){var t=Number(document.getElementById("Municipality_Latitude").value),n=Number(document.getElementById("Municipality_Longitude").value),o=SMap.Coords.fromWGS84(n,t+.04),a=new SMap(JAK.gel("map-canvas"),o,13);a.addDefaultLayer(SMap.DEF_BASE).enable();var c=new SMap.Control.Sync({bottomSpace:30});a.addControl(c)}}();